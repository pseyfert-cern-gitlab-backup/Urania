from ROOT import *
from math import *

gStyle.SetOptStat(0)
gStyle.SetOptFit(0111)

paramnames = ['reA00', 'reA01', 'reA10', 'reA02', 'reA20', 'reA11par', 'reA11perp', 'reA120', 'reA12par', 'reA12perp', 'reA210', 'reA21par', 'reA21perp', 'reA220', 'reA22par', 'reA22perp', 'reA22par2', 'reA22perp2', 'DCP', 'imA00', 'imA01', 'imA10', 'imA02', 'imA20', 'imA11par', 'imA11perp', 'imA120', 'imA12par', 'imA12perp', 'imA210', 'imA21par', 'imA21perp', 'imA220', 'imA22par', 'imA22perp', 'imA22par2', 'imA22perp2', 'phis', 'delta_m_Bs', 'gamma_Bs', 'delta_gamma_Bs', 'p0metac_SSK', 'p0metac_OS', 'Dp0half_SSK', 'Dp0half_OS', 'p1_SSK', 'p1_OS', 'Dp1half_SSK', 'Dp1half_OS', 'tres_p0_2011', 'tres_p1_2011', 'tres_p0_2012', 'tres_p1_2012', 'delta_220', 'f_10', 'delta_22perp', 'delta_210', 'delta_21perp', 'f_par2_22', 'f_01', 'f_00', 'f_02', 'f_12', 'f_L_12', 'f_L_11', 'f_11', 'delta_21par', 'f_perp_12', 'f_perp_11', 'delta_02', 'delta_20', 'f_par_12', 'delta_22perp2', 'f_par_11', 'f_perp_22', 'delta_10', 'f_perp_21', 'delta_22par2', 'f_22', 'f_21', 'f_20', 'f_L_22', 'f_par_22', 'f_par_21', 'f_L_21', 'delta_11perp', 'delta_12par', 'f_perp2_22', 'delta_00', 'delta_12perp', 'delta_01', 'delta_22par', 'delta_11par', 'delta_120']

gROOT.Reset()
fout = TFile("cmasssyst.root","RECREATE")
tout = TTree("Deviations","Deviations")
s = paramnames[0]+'_sigma'
for i in range(1,len(paramnames)): s += ':'+paramnames[i]+'_sigma'
tout.ReadFile("cmasssystfits.dat",s)
tout.Write()

max_exps = 100
tred = tout.CloneTree(0)
for iexp in range(max_exps):
   tout.GetEntry(iexp)
   tred.Fill()

print 'Using',tred.GetEntries(),'experiments.'

par_result_varnw_dict = {'reA22perp': (-0.0735597446872891, 0.30306422294354984, 'Re(A^{TT}_{\\perp1})'), 'reA22par2': (-0.11027482204968209, 0.1972660406076309, 'Re(A^{TT}_{\\parallel2})'), 'delta_210': (1.5818771289499283, 0.1996357045583519, '\\delta^{TV}_{0}'), 'tres_p1_2012': (1.2616281236695952, 0.05274779635421897, 'p_{1}^{\\sigma_{t}}(2012)'), 'tres_p1_2011': (1.1538295242847139, 0.04960299287000747, 'p_{1}^{\\sigma_{t}}(2011)'), 'delta_00': (0.631168448200234, 0.11360173260090543, '\\delta^{SS}'), 'reA10': (-0.48302864950598234, 0.4763598870652409, 'Re(A^{VS})'), 'p0metac_OS': (0.007847072990527244, 0.004354351076796169, 'p_{0}^{OS}-<\\eta^{OS}>'), 'reA220': (0.09894281879607014, 0.15932942348995033, 'Re(A^{TT}_{L})'), 'reA20': (1.050699228614123, 0.31398789866659826, 'Re(A^{TS})'), 'delta_10': (1.7135280268369553, 0.13459951553288768, '\\delta^{VS}'), 'imA21par': (0.4244950066013349, 0.17314585466911223, 'Im(A^{TV}_{\\parallel})'), 'reA11par': (-0.7111304320426761, 0.1707175215323854, 'Re(A^{VV}_{\\parallel})'), 'delta_11par': (2.0879480096016994, 0.12338043142235076, '\\delta^{VV}_{\\parallel}'), 'DCP': (-3.3367627658250862, 0.032947673811672316, '\\Delta^{CP}'), 'imA22perp2': (-0.16116796651845533, 0.28192381916693593, 'Im(A^{TT}_{\\perp2})'), 'delta_12par': (-2.380342007468954, 0.4875078541657935, '\\delta^{VT}_{\\parallel}'), 'delta_01': (-1.8257969059834425, 0.1265241923734855, '\\delta^{SV}'), 'imA22par': (0.341353948048404, 0.13913848147616975, 'Im(A^{TT}_{\\parallel1})'), 'delta_02': (-2.8598839100075946, 0.4801574976201071, '\\delta^{ST}'), 'reA22par': (-0.3445272298732682, 0.12515622178853059, 'Re(A^{TT}_{\\parallel1})'), 'tres_p0_2012': (0.03645129885555397, 0.0002505952651479666, 'p_{0}^{\\sigma_{t}}(2012)'), 'delta_22perp': (1.7208325809900469, 0.609483181030259, '\\delta^{TT}_{\\perp1}'), 'reA21par': (0.5995319172808244, 0.20361029898967656, 'Re(A^{TV}_{\\parallel})'), 'delta_21par': (0.6161042782711134, 0.29462562756538346, '\\delta^{TV}_{\\parallel}'), 'Dp1half_SSK': (-0.015254926677277458, 0.022672452211574556, '1/2 \\Delta p_{1}^{SSK}'), 'delta_11perp': (1.939258354068904, 0.28906842605122646, '\\delta^{VV}_{\\perp}'), 'f_perp2_22': (0.3459135354425529, 0.16551808739606666, 'f_{\\perp2}^{TT}'), 'imA210': (1.510610109476234, 0.4920780258126781, 'Im(A^{TV}_{L})'), 'tres_p0_2011': (0.034768435155261665, 0.00024408794786592213, 'p_{0}^{\\sigma_{t}}(2011)'), 'reA120': (-2.1784357982662, 0.36055834688344035, 'Re(A^{VT}_{L})'), 'imA21perp': (-0.5746150091963251, 0.3317724599697678, 'Im(A^{TV}_{\\perp})'), 'p1_SSK': (0.9284621096763134, 0.08203189533067752, 'p_{1}^{SSK}'), 'delta_22perp2': (-0.3088856089140464, 0.5483218394248964, '\\delta^{TT}_{\\perp2}'), 'reA22perp2': (0.5050716648410116, 0.18681474451094834, 'Re(A^{TT}_{\\perp2})'), 'imA10': (3.3611597476834234, 0.5685389043191992, 'Im(A^{VS})'), 'delta_21perp': (-0.7562188100342472, 0.45664851255489214, '\\delta^{TV}_{\\perp}'), 'p1_OS': (0.9921874478452092, 0.034777221443417, 'p_{1}^{OS}'), 'delta_22par2': (2.347811003368292, 0.5558901241050392, '\\delta^{TT}_{\\parallel2}'), 'f_22': (0.009183543958251066, 0.002710016746295089, 'f_{TT}'), 'f_21': (0.03981873583149521, 0.015123580018046921, 'f_{TV}'), 'f_20': (0.03310278020366144, 0.008536957807655132, 'f_{TS}'), 'f_L_22': (0.036102805589920135, 0.06586150916120274, 'f_L^{TT}'), 'f_par_22': (0.2894851364984548, 0.14091024973977384, 'f_{\\parallel1}^{TT}'), 'f_par_21': (0.1531693158498012, 0.0767161393034345, 'f_{\\parallel}^{TV}'), 'f_L_21': (0.6477838851780799, 0.1379919834577876, 'f_L^{TV}'), 'imA12perp': (0.6465140084462302, 0.3426703743019514, 'Im(A^{VT}_{\\perp})'), 'delta_12perp': (2.53482884577029, 0.3457365178678489, '\\delta^{VT}_{\\perp}'), 'imA220': (0.13980594039667693, 0.17676002217462136, 'Im(A^{TT}_{L})'), 'delta_m_Bs': (17.618112578577502, 0.08167342453732405, '\\Delta m_{B_{s}^{0}}'), 'reA12par': (-0.3186859258260526, 0.17613552448981823, 'Re(A^{VT}_{\\parallel})'), 'c3_mass_swave': (-0.12163136947109421, 0.015311277312228132, 'c_{3}^{mass}'), 'f_par2_22': (0.03044213597889084, 0.09062559060729963, 'f_{\\parallel2}^{TT}'), 'Dp1half_OS': (0.03281067190533479, 0.005993065192385953, '1/2 \\Delta p_{1}^{OS}'), 'f_12': (0.08757804498973039, 0.016427834106826203, 'f_{VT}'), 'f_10': (0.1303213636776544, 0.026296301333162454, 'f_{VS}'), 'f_11': (0.07616112111945339, 0.004601382942301318, 'f_{VV}'), 'imA02': (-0.2048655009177569, 0.4007347003486179, 'Im(A^{ST})'), 'imA00': (2.9507002982943504, 0.5371212442342594, 'Im(A^{SS})'), 'imA01': (-5.2689983817717, 0.6839567507571603, 'Im(A^{SV})'), 'f_par_12': (0.02500600274793292, 0.016866740062547975, 'f_{\\parallel}^{VT}'), 'f_par_11': (0.3070129636679346, 0.03108602287567394, 'f_{\\parallel}^{VV}'), 'Dp0half_SSK': (-0.008046528953707959, 0.0013825312086699188, '1/2 \\Delta p_{0}^{SSK}'), 'Dp0half_OS': (0.006991268663015419, 0.0005991390332970243, '1/2 \\Delta p_{0}^{OS}'), 'reA11perp': (-0.6899895993962257, 0.5062901825849236, 'Re(A^{VV}_{\\perp})'), 'imA120': (-1.2344797129847294, 0.5482780643632025, 'Im(A^{VT}_{L})'), 'f_01': (0.3350944491270055, 0.026523196352403106, 'f_{SV}'), 'f_00': (0.28260212099378823, 0.011846024723397712, 'f_{SS}'), 'f_02': (0.006137840098960122, 0.006346585560303772, 'f_{ST}'), 'c2_mass_swave': (-0.1585889977425825, 0.019406249576048952, 'c_{2}^{mass}'), 'gamma_Bs': (0.6652886270365236, 0.0019676362639323717, '\\Gamma_{B_{s}^{0}}'), 'f_perp_22': (0.29805638649018135, 0.175797243473789, 'f_{\\perp1}^{TT}'), 'f_perp_21': (0.1990467989721187, 0.08647930477048982, 'f_{\\perp}^{TV}'), 'p0metac_SSK': (0.007267043982177306, 0.0050547756388464845, 'p_{0}^{SSK}-<\\eta^{SSK}>'), 'imA22perp': (0.48659539088895976, 0.17633566825012784, 'Im(A^{TT}_{\\perp1})'), 'delta_22par': (2.3608210338061837, 0.2476696658388352, '\\delta^{TT}_{\\parallel1}'), 'imA22par2': (0.1121394730466374, 0.15228187961329426, 'Im(A^{TT}_{\\parallel2})'), 'reA210': (-0.016739456875580316, 0.30160556974705827, 'Re(A^{TV}_{L})'), 'imA20': (-1.3509011615458704, 0.4597895405179997, 'Im(A^{TS})'), 'imA11perp': (1.7870985799327919, 0.3351760719874725, 'Im(A^{VV}_{\\perp})'), 'f_L_12': (0.8090935533665471, 0.04438116437559516, 'f_L^{VT}'), 'f_L_11': (0.148397361829253, 0.03217543911569287, 'f_L^{VV}'), 'f_perp_12': (0.16590044388551997, 0.04088094574994784, 'f_{\\perp}^{VT}'), 'f_perp_11': (0.5445896745028123, 0.035406105850297326, 'f_{\\perp}^{VV}'), 'c1_mass_swave': (-0.2999145131367409, 0.019871084784432978, 'c_{1}^{mass}'), 'c4_mass_swave': (-0.06590222906448306, 0.01627658856871813, 'c_{4}^{mass}'), 'delta_120': (-2.6260322629041277, 0.2118507085715715, '\\delta^{VT}_{0}'), 'delta_220': (0.9549109802328231, 1.0338830362523146, '\\delta^{TT}_{0}'), 'reA21perp': (0.6091668037771996, 0.2557623291630649, 'Re(A^{TV}_{\\perp})'), 'imA11par': (1.250260291892074, 0.2011418584802664, 'Im(A^{VV}_{\\parallel})'), 'reA12perp': (-0.9314251460156928, 0.26684696226308574, 'Re(A^{VT}_{\\perp})'), 'reA01': (-1.3734982090884902, 0.6999374641380647, 'Re(A^{SV})'), 'reA00': (4.037045611521224, 0.6638886334615056, 'Re(A^{SS})'), 'reA02': (-0.7078844807364177, 0.3375555170255883, 'Re(A^{ST})'), 'delta_gamma_Bs': (0.08618311902645703, 0.005877584711519312, '\\Delta \\Gamma_{B_{s}^{0}}'), 'delta_20': (-0.9097539304184619, 0.26934040460890546, '\\delta^{TS}'), 'imA12par': (-0.3036550155575686, 0.1943687862124656, 'Im(A^{VT}_{\\parallel})'), 'phis': (8.596993560492631, 0.11451831052010514, '\\phi_{s}')}

par_result_constnw_dict = {'reA22perp': (-0.07422561735003441, 0.30196831409329866, 'Re(A^{TT}_{\\perp1})'), 'reA22par2': (-0.10977919188605512, 0.1969467132682363, 'Re(A^{TT}_{\\parallel2})'), 'delta_210': (1.5821781346585668, 0.1981172086800449, '\\delta^{TV}_{0}'), 'tres_p1_2012': (1.2616172078197445, 0.05274733982469428, 'p_{1}^{\\sigma_{t}}(2012)'), 'tres_p1_2011': (1.1539493276078308, 0.04959945287409409, 'p_{1}^{\\sigma_{t}}(2011)'), 'delta_00': (0.6310210893525537, 0.11351159667910327, '\\delta^{SS}'), 'reA10': (-0.4818825157334441, 0.47365236797142235, 'Re(A^{VS})'), 'p0metac_OS': (0.007850008602655344, 0.004354135912606459, 'p_{0}^{OS}-<\\eta^{OS}>'), 'reA220': (0.0985546512663742, 0.15815104912571393, 'Re(A^{TT}_{L})'), 'reA20': (1.0516015547119792, 0.31317561659821613, 'Re(A^{TS})'), 'delta_10': (1.7132189785482739, 0.13416062005435211, '\\delta^{VS}'), 'imA21par': (0.4251439690837895, 0.1723387698462173, 'Im(A^{TV}_{\\parallel})'), 'reA11par': (-0.7109611904442712, 0.1694735475125885, 'Re(A^{VV}_{\\parallel})'), 'delta_11par': (2.087802732833163, 0.12308318381645929, '\\delta^{VV}_{\\parallel}'), 'DCP': (-3.336834100942994, 0.03287398843756592, '\\Delta^{CP}'), 'imA22perp2': (-0.16017658850499394, 0.2803961640688439, 'Im(A^{TT}_{\\perp2})'), 'delta_12par': (-2.3814153498007187, 0.4858169819583023, '\\delta^{VT}_{\\parallel}'), 'delta_01': (-1.8257092884062862, 0.1263191445923095, '\\delta^{SV}'), 'imA22par': (0.3419378753751161, 0.13752878188335022, 'Im(A^{TT}_{\\parallel1})'), 'delta_02': (-2.857160118115828, 0.47274460719310313, '\\delta^{ST}'), 'reA22par': (-0.3443091927769686, 0.12473477815416364, 'Re(A^{TT}_{\\parallel1})'), 'tres_p0_2012': (0.03645114009699407, 0.0002505979594572659, 'p_{0}^{\\sigma_{t}}(2012)'), 'delta_22perp': (1.7220630481453068, 0.6068097981807193, '\\delta^{TT}_{\\perp1}'), 'reA21par': (0.5991810972844451, 0.20048019097624487, 'Re(A^{TV}_{\\parallel})'), 'delta_21par': (0.6171011194695819, 0.2931333941312186, '\\delta^{TV}_{\\parallel}'), 'Dp1half_SSK': (-0.015252433759744, 0.02267245458974212, '1/2 \\Delta p_{1}^{SSK}'), 'delta_11perp': (1.9394703452298034, 0.2881908887576033, '\\delta^{VV}_{\\perp}'), 'f_perp2_22': (0.3460059775570623, 0.16484572975915102, 'f_{\\perp2}^{TT}'), 'imA210': (1.5102268561062537, 0.4778143327322305, 'Im(A^{TV}_{L})'), 'tres_p0_2011': (0.03476863646795697, 0.0002440777049750134, 'p_{0}^{\\sigma_{t}}(2011)'), 'reA120': (-2.1785122175811287, 0.34825829429934446, 'Re(A^{VT}_{L})'), 'imA21perp': (-0.574353831446091, 0.32886184423286374, 'Im(A^{TV}_{\\perp})'), 'p1_SSK': (0.9284973212063521, 0.08203250815863705, 'p_{1}^{SSK}'), 'delta_22perp2': (-0.3067485685969915, 0.5462375613821242, '\\delta^{TT}_{\\perp2}'), 'reA22perp2': (0.5056938564147693, 0.1840698448164958, 'Re(A^{TT}_{\\perp2})'), 'imA10': (3.360560226771071, 0.5514299069545597, 'Im(A^{VS})'), 'delta_21perp': (-0.7558653134786215, 0.4553535164687906, '\\delta^{TV}_{\\perp}'), 'p1_OS': (0.99219232383791, 0.03477676955135745, 'p_{1}^{OS}'), 'delta_22par2': (2.3483756053393314, 0.5569098125220759, '\\delta^{TT}_{\\parallel2}'), 'f_22': (0.009190427376370798, 0.0025771240213735783, 'f_{TT}'), 'f_21': (0.03980257668484872, 0.014938927020175068, 'f_{TV}'), 'f_20': (0.03306503436487386, 0.008311810262891958, 'f_{TS}'), 'f_L_22': (0.035988475857040986, 0.06528084079672292, 'f_L^{TT}'), 'f_par_22': (0.289549103216287, 0.13893711665914796, 'f_{\\parallel1}^{TT}'), 'f_par_21': (0.15325532638545658, 0.07631665134068205, 'f_{\\parallel}^{TV}'), 'f_L_21': (0.6476661360893627, 0.13665318787409053, 'f_L^{TV}'), 'imA12perp': (0.6464527993749307, 0.3380842423951303, 'Im(A^{VT}_{\\perp})'), 'delta_12perp': (2.5349053337112566, 0.3443488486550821, '\\delta^{VT}_{\\perp}'), 'imA220': (0.1398353600400437, 0.17567075415228617, 'Im(A^{TT}_{L})'), 'delta_m_Bs': (17.618187151401123, 0.08154198312412247, '\\Delta m_{B_{s}^{0}}'), 'reA12par': (-0.31930626006862717, 0.17557387952245063, 'Re(A^{VT}_{\\parallel})'), 'f_par2_22': (0.030109314086630416, 0.08987353354164121, 'f_{\\parallel2}^{TT}'), 'Dp1half_OS': (0.032810295120572514, 0.0059930725915674265, '1/2 \\Delta p_{1}^{OS}'), 'f_12': (0.08759040112806357, 0.016047487186664218, 'f_{VT}'), 'f_10': (0.13025199050985692, 0.026200440477220206, 'f_{VS}'), 'f_11': (0.07617187057781845, 0.004356888035288296, 'f_{VV}'), 'imA02': (-0.2071742359647235, 0.39858323017051434, 'Im(A^{ST})'), 'imA00': (2.950222600890669, 0.5278798586734365, 'Im(A^{SS})'), 'imA01': (-5.2699240019240055, 0.6658921641900798, 'Im(A^{SV})'), 'f_par_12': (0.025046495327613896, 0.016845628196663742, 'f_{\\parallel}^{VT}'), 'f_par_11': (0.30695364835891303, 0.030981855730300642, 'f_{\\parallel}^{VV}'), 'Dp0half_SSK': (-0.008046602303667357, 0.001382531168358857, '1/2 \\Delta p_{0}^{SSK}'), 'Dp0half_OS': (0.006991298101529059, 0.0005991385174119489, '1/2 \\Delta p_{0}^{OS}'), 'reA11perp': (-0.6905062283293439, 0.5065293296489629, 'Re(A^{VV}_{\\perp})'), 'imA120': (-1.2348994137129825, 0.5495577193175852, 'Im(A^{VT}_{L})'), 'f_01': (0.3351677332276821, 0.02634701841450725, 'f_{SV}'), 'f_00': (0.2826000021084217, 0.011196741961466809, 'f_{SS}'), 'f_02': (0.0061599640220634235, 0.00627054588714095, 'f_{ST}'), 'gamma_Bs': (0.6652948018876358, 0.0019676001535852616, '\\Gamma_{B_{s}^{0}}'), 'f_perp_22': (0.29834712928297924, 0.17467227158578624, 'f_{\\perp1}^{TT}'), 'f_perp_21': (0.19907853752518076, 0.08567343618799604, 'f_{\\perp}^{TV}'), 'p0metac_SSK': (0.0072683156443861426, 0.005054463205793598, 'p_{0}^{SSK}-<\\eta^{SSK}>'), 'imA22perp': (0.4869452914280803, 0.17006688302646072, 'Im(A^{TT}_{\\perp1})'), 'delta_22par': (2.3596499628257757, 0.24557581181269467, '\\delta^{TT}_{\\parallel1}'), 'imA22par2': (0.11150945761584197, 0.15193267680161224, 'Im(A^{TT}_{\\parallel2})'), 'reA210': (-0.01718985420287389, 0.29924764555120864, 'Re(A^{TV}_{L})'), 'imA20': (-1.3490558625999487, 0.44744884891439557, 'Im(A^{TS})'), 'imA11perp': (1.787308938055146, 0.32626556405752466, 'Im(A^{VV}_{\\perp})'), 'f_L_12': (0.8090857398581417, 0.044326949627353104, 'f_L^{VT}'), 'f_L_11': (0.14836351599278935, 0.031125824121668144, 'f_L^{VV}'), 'f_perp_12': (0.1658677648142444, 0.04083604561846762, 'f_{\\perp}^{VT}'), 'f_perp_11': (0.5446828356482976, 0.03490751511367655, 'f_{\\perp}^{VV}'), 'delta_120': (-2.625901493225181, 0.21144117432938692, '\\delta^{VT}_{0}'), 'delta_220': (0.956862406555501, 1.035629568782537, '\\delta^{TT}_{0}'), 'reA21perp': (0.6093212980725085, 0.25604379415708045, 'Re(A^{TV}_{\\perp})'), 'imA11par': (1.2503853970601604, 0.19677954156957847, 'Im(A^{VV}_{\\parallel})'), 'reA12perp': (-0.9314890543650254, 0.2669399783880778, 'Re(A^{VT}_{\\perp})'), 'reA01': (-1.37324639290979, 0.6946509686112958, 'Re(A^{SV})'), 'reA00': (4.0376408177766105, 0.6447494620532553, 'Re(A^{SS})'), 'reA02': (-0.7086282910442794, 0.3299463684258643, 'Re(A^{ST})'), 'delta_gamma_Bs': (0.08615678124351381, 0.005877617862059901, '\\Delta \\Gamma_{B_{s}^{0}}'), 'delta_20': (-0.9086752081549326, 0.26783250625243554, '\\delta^{TS}'), 'imA12par': (-0.3035928765349514, 0.1938745686541677, 'Im(A^{VT}_{\\parallel})'), 'phis': (8.597144924350035, 0.11442558567490102, '\\phi_{s}')}

par_name_dict = {'mV': 'mV', 'gammaV': 'gammaV', 'mT': 'mT', 'gammaT': 'gammaT', 'c1_mass_swave': 'c_{1}^{mass}','c2_mass_swave': 'c_{2}^{mass}','c3_mass_swave': 'c_{3}^{mass}','c4_mass_swave': 'c_{4}^{mass}','c5_mass_swave': 'c_{5}^{mass}','c6_mass_swave': 'c_{6}^{mass}','c7_mass_swave': 'c_{7}^{mass}','c8_mass_swave': 'c_{8}^{mass}','c9_mass_swave': 'c_{9}^{mass}', 'reA22perp': 'Re(A^{TT}_{#perp1})', 'reA22par2': 'Re(A^{TT}_{#parallel2})', 'delta_210': '#delta^{TV}_{0}', 'tres_p1_2012': 'p_{1}^{#sigma_{t}}(2012)', 'tres_p1_2011': 'p_{1}^{#sigma_{t}}(2011)', 'delta_00': '#delta^{SS}', 'reA10': 'Re(A^{VS})', 'p0metac_OS': 'p_{0}^{OS}-<#eta^{OS}>', 'reA220': 'Re(A^{TT}_{L})', 'reA20': 'Re(A^{TS})', 'delta_10': '#delta^{VS}', 'imA21par': 'Im(A^{TV}_{#parallel})', 'reA11par': 'Re(A^{VV}_{#parallel})', 'delta_11par': '#delta^{VV}_{#parallel}', 'DCP': '#Delta^{CP}', 'DCP_SS': 'd#Delta^{CP}_{SS}', 'DCP_SV': 'd#Delta^{CP}_{SV}', 'DCP_VS': 'd#Delta^{CP}_{VS}', 'DCP_ST': 'd#Delta^{CP}_{ST}', 'DCP_TS': 'd#Delta^{CP}_{TS}', 'DCP_VT': 'd#Delta^{CP}_{VT}', 'DCP_TV': 'd#Delta^{CP}_{TV}', 'DCP_TT': 'd#Delta^{CP}_{TT}', 'imA22perp2': 'Im(A^{TT}_{#perp2})', 'delta_12par': '#delta^{VT}_{#parallel}', 'delta_01': '#delta^{SV}', 'imA22par': 'Im(A^{TT}_{#parallel1})', 'delta_02': '#delta^{ST}', 'reA22par': 'Re(A^{TT}_{#parallel1})', 'p1_SSK': 'p_{1}^{SSK}', 'delta_22perp': '#delta^{TT}_{#perp1}', 'reA21par': 'Re(A^{TV}_{#parallel})', 'delta_21par': '#delta^{TV}_{#parallel}', 'Dp1half_SSK': '1/2 #Delta p_{1}^{SSK}', 'delta_11perp': '#delta^{VV}_{#perp}', 'f_perp2_22': 'f_{#perp2}^{TT}', 'imA210': 'Im(A^{TV}_{L})', 'tres_p0_2011': 'p_{0}^{#sigma_{t}}(2011)', 'reA120': 'Re(A^{VT}_{L})', 'imA21perp': 'Im(A^{TV}_{#perp})', 'tres_p0_2012': 'p_{0}^{#sigma_{t}}(2012)', 'delta_22perp2': '#delta^{TT}_{#perp2}', 'reA22perp2': 'Re(A^{TT}_{#perp2})', 'imA10': 'Im(A^{VS})', 'delta_21perp': '#delta^{TV}_{#perp}', 'p1_OS': 'p_{1}^{OS}', 'delta_22par2': '#delta^{TT}_{#parallel2}', 'f_22': 'f_{TT}', 'f_21': 'f_{TV}', 'f_20': 'f_{TS}', 'f_L_22': 'f_L^{TT}', 'f_par_22': 'f_{#parallel1}^{TT}', 'f_par_21': 'f_{#parallel}^{TV}', 'f_L_21': 'f_L^{TV}', 'imA12perp': 'Im(A^{VT}_{#perp})', 'delta_12perp': '#delta^{VT}_{#perp}', 'imA220': 'Im(A^{TT}_{L})', 'delta_m_Bs': '#Delta m_{B_{s}^{0}}', 'reA12par': 'Re(A^{VT}_{#parallel})', 'f_par2_22': 'f_{#parallel2}^{TT}', 'Dp1half_OS': '1/2 #Delta p_{1}^{OS}', 'f_12': 'f_{VT}', 'f_10': 'f_{VS}', 'f_11': 'f_{VV}', 'imA02': 'Im(A^{ST})', 'imA00': 'Im(A^{SS})', 'imA01': 'Im(A^{SV})', 'f_par_12': 'f_{#parallel}^{VT}', 'f_par_11': 'f_{#parallel}^{VV}', 'reA01': 'Re(A^{SV})', 'Dp0half_OS': '1/2 #Delta p_{0}^{OS}', 'reA11perp': 'Re(A^{VV}_{#perp})', 'imA120': 'Im(A^{VT}_{L})', 'f_01': 'f_{SV}', 'f_00': 'f_{SS}', 'f_02': 'f_{ST}', 'gamma_Bs': '#Gamma_{B_{s}^{0}}', 'f_perp_22': 'f_{#perp1}^{TT}', 'f_perp_21': 'f_{#perp}^{TV}', 'p0metac_SSK': 'p_{0}^{SSK}-<#eta^{SSK}>', 'imA22perp': 'Im(A^{TT}_{#perp1})', 'delta_22par': '#delta^{TT}_{#parallel1}', 'imA22par2': 'Im(A^{TT}_{#parallel2})', 'reA210': 'Re(A^{TV}_{L})', 'imA20': 'Im(A^{TS})', 'imA11perp': 'Im(A^{VV}_{#perp})', 'f_L_12': 'f_L^{VT}', 'f_L_11': 'f_L^{VV}', 'f_perp_12': 'f_{#perp}^{VT}', 'f_perp_11': 'f_{#perp}^{VV}', 'delta_120': '#delta^{VT}_{0}', 'delta_220': '#delta^{TT}_{0}', 'reA21perp': 'Re(A^{TV}_{#perp})', 'imA11par': 'Im(A^{VV}_{#parallel})', 'reA12perp': 'Re(A^{VT}_{#perp})', 'Dp0half_SSK': '1/2 #Delta p_{0}^{SSK}', 'reA00': 'Re(A^{SS})', 'reA02': 'Re(A^{ST})', 'delta_gamma_Bs': '#Delta #Gamma_{B_{s}^{0}}', 'delta_20': '#delta^{TS}', 'imA12par': 'Im(A^{VT}_{#parallel})', 'phis': '#phi_{s}', 'dphi_SS': 'd#phi_{sSS}', 'dphi_SV': 'd#phi_{sSV}', 'dphi_VS': 'd#phi_{sVS}', 'dphi_ST': 'd#phi_{sST}', 'dphi_TS': 'd#phi_{sTS}', 'dphi_VT': 'd#phi_{sVT}', 'dphi_TV': 'd#phi_{sTV}', 'dphi_TT': 'd#phi_{sTT}'}

syst_error_dict = {}

hlist = []
for ipar in range(len(paramnames)):
   par = paramnames[ipar]
   hlist.append(TH1F('h_'+par,'h_'+par,1000,-1,1))
   tred.Draw(par+'_sigma>>h_'+par)
   sigma_varnw = par_result_varnw_dict[par][1]
   sigma_constnw = par_result_constnw_dict[par][1]
   sigma_varcmass = hlist[ipar].GetRMS()
   sigma_combined = sqrt(sigma_constnw**2+sigma_varcmass**2)
   title = par_name_dict[par]
   syst_error_dict[par] = (sigma_varnw,sigma_combined,title)

h = TH1F("h","h",100,-20,20)
for par in paramnames:
   h.Fill((syst_error_dict[par][1]-syst_error_dict[par][0])/syst_error_dict[par][0])
   print syst_error_dict[par][2]+' =  +- '+'{:.3f}'.format(syst_error_dict[par][0])+' +- '+'{:.3f}'.format(syst_error_dict[par][1])

h.Draw()
